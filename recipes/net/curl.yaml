inherit: [autotools]

metaEnvironment:
    PKG_VERSION: "7.74.0"

depends:
    - libs::openssl-dev

    - use: []
      depends:
        - libs::openssl-tgt

checkoutSCM:
    scm: url
    url: https://curl.haxx.se/download/curl-${PKG_VERSION}.tar.xz
    digestSHA1: "2bc01055f1a2212ef22f90f026f3a8f9c73d16c1"
    stripComponents: 1

# ./configure will delete curlbuild.h
checkoutDeterministic: True
checkoutScript: |
    if [[ -f include/curl/curlbuild.h ]] ; then
        rm -f include/curl/curlbuild.h
    fi

buildScript: |
    autotoolsBuild $1 \
       --enable-threaded-resolver \
       --with-ssl \
       --with-ca-path=/etc/ssl/certs
    echo "Requires: openssl" >> install/usr/lib/pkgconfig/libcurl.pc

multiPackage:
    dev:
        packageScript: autotoolsPackageDev
        provideDeps: [ "*-dev" ]

    tgt:
        packageScript: autotoolsPackageTgt
        provideDeps: [ "*-tgt" ]
